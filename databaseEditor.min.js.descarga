"use strict";define("databaseEditor/mixins/dbEditorApiContextMixin",["react"],function(e){return{contextTypes:{dbEditorApi:e.PropTypes.object.isRequired},getDbEditorApi:function(){return this.context.dbEditorApi}}}),define("databaseEditor/components/itemDetails.rt",["react","lodash","baseUI"],function(e,t,i){return function(){function s(){var s=this.getImageDef();return e.createElement("span",{key:"item-img-container",className:t({"item-thumb-img":!0,noImage:!s.imageValid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},s.imageValid?e.createElement("img",t.assign({},{key:"item-img-thumb"},s.props)):null,s.imageValid?null:e.createElement(i.symbol,{name:"camera",key:"item-img-symbol"}))}return e.createElement("div",{className:"item-details",onClick:this.editItem},this.props.showImage&&this.getImageDef().imageVisible?s.apply(this,[]):null,e.createElement("span",{className:"item-title"},t.unescape(this.props.item.title)||"(Untitled Item)"))}}),define("databaseEditor/components/itemDetails",["lodash","react","util","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemDetails.rt"],function(e,t,i,s,a){function n(t,i){return e.find(t,function(t,s){return"wix:Image"===t._type&&e.includes(i,s)})}function r(e,t){var s={uri:e.src,width:e.width,height:e.height},a=i.imageTransform.getData(i.imageTransform.fittingTypes.SCALE_TO_FILL,{width:s.width,height:s.height,id:s.uri},{width:43,height:43,alignment:i.imageTransform.alignTypes.CENTER,htmlTag:"img"});return{src:t.getServiceTopology().staticMediaUrl+"/"+a.uri,style:a.css.img}}return t.createClass({displayName:"itemDetails",mixins:[i.translationMixin,s],propTypes:{item:t.PropTypes.object.isRequired,showImage:t.PropTypes.bool,visibleFields:t.PropTypes.arrayOf(t.PropTypes.string)},getDefaultProps:function(){return{showImage:!0}},getImageDef:function(){var t=n(this.props.item,this.props.visibleFields),i=!!t,s=i&&!e.isEmpty(t.src);return{imageVisible:i,imageValid:s,props:s?r(t,this.getDbEditorApi()):null}},editItem:function(){this.getDbEditorApi().setCurrentItem(this.props.item._iid,"hover_item")},render:a})}),define("databaseEditor/components/itemActionMenu.rt",["react","lodash","baseUI","experiment"],function(e,t,i,s){return function(){function t(e){e.stopPropagation()}return e.createElement("div",{className:"item-action-menu",onClick:t.bind(this)},e.createElement("div",{className:"action-buttons-container"},e.createElement(i.button,{className:"duplicate-item-button",label:"list_dbe_hover_item_duplicate_tooltip",icon:"duplicate",onClick:this.duplicateItem}),e.createElement(i.button,{className:"delete-item-button",label:"list_dbe_hover_item_delete_tooltip",icon:"delete",onClick:this.deleteItem}),this.props.isHidden?e.createElement(i.button,{key:"hoverItemShowBtn",className:"show-item-button",label:"list_dbe_hover_item_show",icon:"quickActionsShow",onClick:this.showItem}):null,this.props.isHidden?null:e.createElement(i.button,{key:"hoverItemHideBtn",className:"hide-item-button",label:"list_dbe_hover_item_hide",icon:"quickActionsHide",onClick:this.hideItem}),e.createElement(i.button,{className:"edit-item-button",label:"list_dbe_hover_item_edit",icon:"pencil",onClick:this.editItem})))}}),define("databaseEditor/components/itemActionMenu",["react","util","databaseEditor/components/itemActionMenu.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s){return e.createClass({displayName:"itemActionMenu",mixins:[t.translationMixin,s],propTypes:{item:e.PropTypes.object.isRequired,isHidden:e.PropTypes.bool.isRequired},editItem:function(){var e=this.props.item._iid;this.getDbEditorApi().setCurrentItem(e,"hover_item")},duplicateItem:function(){this.getDbEditorApi().duplicateItems([this.props.item],"hover_item")},deleteItem:function(){this.getDbEditorApi().deleteItems([this.props.item],"hover_item")},showItem:function(){this.getDbEditorApi().showItems([this.props.item],"hover_item")},hideItem:function(){this.getDbEditorApi().hideItems([this.props.item],"hover_item")},render:i})}),define("databaseEditor/components/itemListRow.rt",["react","lodash","baseUI","baseUILib","databaseEditor/components/itemDetails","databaseEditor/components/itemActionMenu"],function(e,t,i,s,a,n){return function(){return e.createElement("div",function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"item-list-row"},this.filteredProps()),this.props.isOpened?null:e.createElement("span",{className:"drag-handle-container",key:"drag-handle",onMouseDown:this.props.onStartDrag},e.createElement(i.symbol,{name:"dragHandle",className:"symbol-dragHandle"})),this.props.isOpened?null:e.createElement(s.Checkbox,{key:"item-checkbox",labelAfterSymbol:!0,value:this.props.isSelected,onChange:this.props.onSelect}),e.createElement(a,{className:t({draggable:!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),item:this.props.item,showImage:!this.props.isOpened,visibleFields:this.props.visibleFields,isHidden:this.props.isHidden}),e.createElement(n,{item:this.props.item,isHidden:this.props.isHidden}))}}),define("databaseEditor/components/itemListRow",["react","lodash","databaseEditor/components/itemListRow.rt","util"],function(e,t,i,s){return e.createClass({displayName:"itemListRow",mixins:[s.propTypesFilterMixin],propTypes:{item:e.PropTypes.object.isRequired,isOpened:e.PropTypes.bool.isRequired,isSelected:e.PropTypes.bool.isRequired,visibleFields:e.PropTypes.arrayOf(e.PropTypes.string),onSelect:e.PropTypes.func.isRequired,onStartDrag:e.PropTypes.func},render:i})}),define("databaseEditor/components/noItems.rt",["react","lodash","baseUI"],function(e,t,i){return function(){return e.createElement("div",{className:"no-items"},e.createElement(i.symbol,{name:"createYourFirstItem",className:"no-items-image"}),e.createElement("span",{className:"no-items-title"},this.translateIfNeeded("list_dbe_this_list_is_empty")),e.createElement("div",{className:"no-items-click-container"},e.createElement("span",{},this.translateIfNeeded("list_dbe_empty_sate_line2"))))}}),define("databaseEditor/components/noItems",["react","lodash","databaseEditor/components/noItems.rt","databaseEditor/mixins/dbEditorApiContextMixin","util"],function(e,t,i,s,a){return e.createClass({displayName:"noItems",mixins:[s,a.translationMixin],render:i})}),define("databaseEditor/components/itemListFilter/itemListFilter.rt",["react","lodash","baseUI","symbols"],function(e,t,i,s){return function(){return e.createElement("span",{className:t({"item-list-filter":!0,"is-open":this.state.isBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("span",{},this.translateIfNeeded("list_dbe_items_filter_label")," "),e.createElement("span",{className:"item-list-filter-value-label",ref:"handler",onClick:this.toggleBubble},"\n        ",this.getValueLabel(),"\n        ",e.createElement(s.symbol,{name:"arrowDown"})),this.state.isBubbleOpen?e.createElement(i.bubble,{key:"itemFilterBubble",value:this.getBubbleContent(),closeTriggers:[i.uiConstants.TOOLTIP.TRIGGERS.CLICK,i.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:i.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM,styleType:i.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.closeBubble,targetNode:this.refs.handler}):null)}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble.rt",["react","lodash","symbols"],function(e,t,i){return function(){function s(e,t){this.props.onChange(e.value)}function a(a,n){return e.createElement("div",{key:a.value,onClick:s.bind(this,a,n),className:t({"item-list-filter-bubble-option":!0,selected:this.props.value===a.value}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement(i.symbol,{name:"check"}),e.createElement("span",{},this.translateIfNeeded(a.label)))}return e.createElement.apply(this,["div",{className:"item-list-filter-bubble"},t.map(this.props.options,a.bind(this))])}}),define("databaseEditor/components/itemListFilter/itemListFilterBubble",["react","lodash","util","databaseEditor/components/itemListFilter/itemListFilterBubble.rt"],function(e,t,i,s){return e.createClass({displayName:"itemListFilterBubble",mixins:[i.translationMixin],propTypes:{value:e.PropTypes.any.isRequired,onChange:e.PropTypes.func.isRequired,options:e.PropTypes.arrayOf(e.PropTypes.shape({label:e.PropTypes.string.isRequired,value:e.PropTypes.any.isRequired})).isRequired},render:s})}),define("databaseEditor/components/itemListFilter/itemListFilter",["react","lodash","util","databaseEditor/components/itemListFilter/itemListFilter.rt","databaseEditor/components/itemListFilter/itemListFilterBubble"],function(e,t,i,s,a){function n(e){this.props.onChange(e),this.closeBubble()}var r={all:"list_dbe_items_filter_all",visible:"list_dbe_items_filter_visible",hidden:"list_dbe_items_filter_hidden"};return e.createClass({displayName:"itemListFilter",mixins:[i.translationMixin],propTypes:{value:e.PropTypes.oneOf(["all","visible","hidden"]).isRequired,onChange:e.PropTypes.func.isRequired},getInitialState:function(){return{isBubbleOpen:!1}},getValueLabel:function(){return this.translateIfNeeded(r[this.props.value])},toggleBubble:function(){this.setState({isBubbleOpen:!this.state.isBubbleOpen})},closeBubble:function(){this.setState({isBubbleOpen:!1})},getBubbleContent:function(){return e.createElement(a,{value:this.props.value,onChange:n.bind(this),options:t.map(r,function(e,t){return{label:e,value:t}})})},render:s})}),define("databaseEditor/components/itemsList.rt",["react","lodash","baseUI","baseUILib","uiAnimations","databaseEditor/components/itemListRow","databaseEditor/components/noItems","databaseEditor/components/itemListFilter/itemListFilter"],function(e,t,i,s,a,n,r,l){return function(){function o(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}function d(e,t){this.toggleAllItems()}function c(e,t,i,s){this.toggleItem(i._iid)}function m(e,t,i,s,a){!this.props.openedItemId&&this.refs.sortList.startDrag(s,a)}function p(i,s,a,r){return e.createElement(n,{key:a._iid,item:a,className:t({"hidden-item":!1,selected:this.isSelected(a._iid),"no-hover":s>0,"is-open":this.props.openedItemId===a._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!1,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(a._iid),visibleFields:this.props.visibleFields,onSelect:c.bind(this,i,s,a,r),onStartDrag:m.bind(this,i,s,a,r)})}function u(e,t,i,s){this.toggleItem(i._iid)}function h(i,s,a,r){return e.createElement(n,{key:a._iid,item:a,className:t({"hidden-item":!0,selected:this.isSelected(a._iid),"no-hover":s>0,"is-open":this.props.openedItemId===a._iid}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),isHidden:!0,isOpened:!!this.props.openedItemId,isSelected:this.isSelected(a._iid),visibleFields:this.props.visibleFields,onSelect:u.bind(this,i,s,a,r)})}function b(){var n=i.sortByDragList,c=this.getSelectedIds().length;return e.createElement("div",o({className:"items-list "+(this.props.openedItemId?"small":"")},this.filteredProps()),e.createElement("header",{className:"list-header"},e.createElement("span",{className:"list-header-left-pane"},e.createElement("span",{className:"list-title"},this.props.listName),this.props.openedItemId?null:e.createElement(l,{key:"itemListFilter",value:this.state.itemsFilter,onChange:this.setItemsFilter})),e.createElement(i.button,{className:"add-item-btn",label:"list_dbe_edit_item_add_item",onClick:this.addItem})),e.createElement("div",{className:this.props.openedItemId?"add-item-container":"select-all-container"},e.createElement("span",{className:"select-all-checkbox"},e.createElement(s.Checkbox,{labelAfterSymbol:!0,value:c>0,indeterminate:c>0&&c<this.filteredItems().length,label:this.getItemsSelectionLabel(c),shouldTranslate:!1,onChange:d.bind(this,n,c)})),this.props.openedItemId?e.createElement(i.button,{key:"list-view-add-btn",label:"list_dbe_edit_item_add_item",className:"small-add-item",onClick:this.addItem}):null,this.getSelectedIds().length>0?e.createElement("span",{key:"multi-select-actions",className:"multi-select-action-menu checked"},e.createElement(i.button,{className:"multi-duplicate",label:"list_dbe_duplicate_Items",icon:"duplicate",onClick:this.duplicateSelectedItems}),e.createElement(i.button,{className:"multi-delete",label:"list_dbe_delete_items",icon:"delete",onClick:this.deleteSelectedItems}),e.createElement(i.button,{className:"multi-show-hide",label:"list_dbe_show_hide_multiple_items",icon:"quickActionsShow",onClick:this.showHideSelectedItems})):null),0!==this.allItems().length||this.props.loading?null:e.createElement(r,{key:"no-items"}),e.createElement(s.CustomScroll,{heightRelativeToParent:"calc(100% - 120px)"},e.createElement("div",{className:this.props.openedItemId?"items-container-edit":"items-container"},this.shouldShowVisibleItems()?e.createElement.apply(this,[n,{ref:"sortList",key:"da-list",className:t({"sort-list":!this.props.openedItemId,"item-edit-sort-list":this.props.openedItemId,"visible-items-container":!0}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onItemMoved:this.getDbEditorApi().moveItem,childrenTransition:a.contentAddRemove},t.map(this.props.items,p.bind(this,n,c))]):null,this.shouldShowHiddenItems()?e.createElement.apply(this,["span",{className:"hidden-items-container",key:"hidden-items-container"},t.map(this.props.hiddenItems,h.bind(this,n,c))]):null)))}return b.apply(this,[])}}),define("databaseEditor/components/itemsList",["react","lodash","util","databaseEditor/components/itemsList.rt","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i,s,a){function n(e){var i=this.getSelectedIds();return t.filter(e,function(e){return t.includes(i,e._iid)})}return e.createClass({displayName:"itemsList",mixins:[a,i.selectionMixin,i.propTypesFilterMixin],propTypes:{items:e.PropTypes.array.isRequired,hiddenItems:e.PropTypes.array.isRequired,openedItemId:e.PropTypes.string,listName:e.PropTypes.string.isRequired,listId:e.PropTypes.string.isRequired,visibleFields:e.PropTypes.arrayOf(e.PropTypes.string)},getDefaultProps:function(){return{openedItemId:void 0}},getInitialState:function(){return{itemsFilter:"all"}},duplicateSelectedItems:function(){this.getDbEditorApi().duplicateItems(n.call(this,this.filteredItems()),"multiple_selection"),this.clearSelection()},deleteSelectedItems:function(){this.getDbEditorApi().deleteItems(n.call(this,this.filteredItems()),"multiple_selection",this.clearSelection)},showHideSelectedItems:function(){var e=n.call(this,this.props.items),t=n.call(this,this.props.hiddenItems),i=t.length>0?"showItems":"hideItems";this.getDbEditorApi()[i](e.concat(t),"multiple_selection")},addItem:function(){var e=this.props.openedItemId?"item_view":"list_view";this.getDbEditorApi().addItem(e,function(e){this.getDbEditorApi().setCurrentItem(e)}.bind(this)),this.clearSelection(),t.includes(["all","visible"],this.state.itemsFilter)||this.setState({itemsFilter:"all"})},setCurrentItem:function(e){var t=this.getDbEditorApi(),i=this.props.openedItemId?"item_view":"list_view";t.setCurrentItem(e,i)},toggleItem:function(e){var t=this.isSelected(e);this.toggle(e),this.getDbEditorApi().bi.itemSelectionToggle(this.props.listId,e,!t)},toggleAllItems:function(){var e=t.map(this.filteredItems(),"_iid"),i=!t.isEmpty(this.getSelectedIds());this.toggleAll(e),this.getDbEditorApi().bi.allItemsSelectionToggle(this.props.listId,!i)},getItemsSelectionLabel:function(e){switch(e){case 0:return i.translate("list_dbe_select_all_label");case 1:return i.translate("list_dbe_1_items_selected");default:return i.translate("list_dbe_x_items_selected").replace("<X>",e)}},allItems:function(){return this.props.items.concat(this.props.hiddenItems)},setItemsFilter:function(e){this.setState({itemsFilter:e}),this.clearSelection()},filteredItems:function(){switch(this.state.itemsFilter){case"all":return this.allItems();case"visible":return this.props.items;case"hidden":return this.props.hiddenItems;default:return this.props.items}},shouldShowVisibleItems:function(){return this.props.items.length&&t.includes(["all","visible"],this.state.itemsFilter)},shouldShowHiddenItems:function(){return this.props.hiddenItems.length&&t.includes(["all","hidden"],this.state.itemsFilter)},render:s})}),define("databaseEditor/components/itemEdit.rt",["react","lodash","baseUI","baseUILib"],function(e,t,i,s){return function(){function a(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}function n(e){this.getDbEditorApi().setCurrentItem(null)}function r(e){this.getDbEditorApi().deleteItems([e],"edit_item")}function l(e){this.getDbEditorApi().duplicateItems([e],"edit_item")}function o(t,i,s){return e.createElement("div",{className:"item-field",key:i.definition.name},e.createElement(i.component,{ref:s,item:t,fieldDef:i.definition,placeholder:i.placeholder,visibleSections:{PhoneLink:!1}}))}function d(){var d=this.props.item;return e.createElement("div",a({className:"item-edit",key:this.props.item._iid},this.filteredProps()),e.createElement("div",{className:"no-scroll-container"},e.createElement("header",{className:"item-header"},e.createElement("div",{className:"button-container"},e.createElement(i.button,{className:"close-item-btn",icon:"arrowRight",label:"list_dbe_edit_item_close_item",onClick:n.bind(this,d)})),e.createElement("span",{className:"action-container"},this.state.saveLabel?e.createElement("div",{className:"save-item-label",key:"save-item-label"},this.translateIfNeeded(this.state.saveLabel)):null,e.createElement(i.tooltip,{value:"list_dbe_hover_item_delete_tooltip"},e.createElement(i.button,{className:"delete-item-btn",icon:"delete",onClick:r.bind(this,d)})),e.createElement(i.tooltip,{value:"list_dbe_hover_item_duplicate_tooltip"},e.createElement(i.button,{className:"duplicate-item-btn",icon:"duplicate",onClick:l.bind(this,d)}))))),e.createElement(s.CustomScroll,{heightRelativeToParent:"calc(100% - 67px)"},e.createElement.apply(this,["div",{className:"item-fields-container"},t.map(this.getFields(),o.bind(this,d)),e.createElement("div",{className:"unused-fields-text"},this.translateIfNeeded("list_dbe_edit_hiding_unused_fields"))])))}return d.apply(this,[])}}),define("databaseEditor/components/linkTo/linkToField.rt",["react","lodash","panels","util"],function(e,t,i,s){return function(){return e.createElement(i.commonControls.linkTo,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:s.inheritClassName("input-link-to-field"),value:this.getLinkData(),onChange:this.setLinkData,showButton:!1,showIcon:!0},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToFieldButton.rt",["react","lodash","panels"],function(e,t,i){return function(){return e.createElement(i.commonControls.linkToButton,t.assign({},{value:this.getLinkData(),onChange:this.setLinkData},this.filterProps()))}}),define("databaseEditor/components/linkTo/linkToField",["react","lodash","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/linkTo/linkToField.rt","databaseEditor/components/linkTo/linkToFieldButton.rt"],function(e,t,i,s,a){return e.createClass({displayName:"linkToField",mixins:[i],propTypes:{item:e.PropTypes.object.isRequired,fieldDef:e.PropTypes.object.isRequired,useLinkButton:e.PropTypes.bool,label:e.PropTypes.string,placeholder:e.PropTypes.string,minCharsForTooltip:e.PropTypes.number,showButton:e.PropTypes.bool,buttonEditLabel:e.PropTypes.string,buttonAddLabel:e.PropTypes.string},getDefaultProps:function(){return{useLinkButton:!1}},getLinkData:function(){return this.props.item.links&&this.props.item.links[this.props.fieldDef.name]},setLinkData:function(e){var t={};t[this.props.fieldDef.name]=e,this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,{links:t})},filterProps:function(){return t.omit(this.props,["pages","anchors","value","onChange","valueLink"])},render:function(){return(this.props.useLinkButton?a:s).call(this)}})}),define("databaseEditor/components/itemFields/textItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){return function(){function a(e){this.updateFieldValue(t.escape(e))}return e.createElement("div",{className:"text-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement(i.textInput,{value:t.unescape(this.getFieldValue()),onChange:a.bind(this),maxLength:500,placeholder:this.props.placeholder}),this.hasLink()?null:e.createElement(s,t.assign({},{key:"noLink",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?e.createElement(s,function(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}({className:"input-link-to",key:"hasLink",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null)}}),define("databaseEditor/mixins/itemFieldMixin",["lodash","react","databaseEditor/mixins/dbEditorApiContextMixin"],function(e,t,i){function s(e,t){return(t||[]).reduce(function(e,t){return e&&e[t]},e)}function a(e){return e.reduceRight(function(e,t){var i={};return i[t]=e,i})}return{propTypes:{item:t.PropTypes.object.isRequired,fieldDef:t.PropTypes.object.isRequired},mixins:[i],getFieldDisplayName:function(){return this.props.fieldDef.displayName||this.props.fieldDef.name},getFieldValue:function(e,t){var i=t||this.props,a=i.item[i.fieldDef.name];return e&&(a=s(a,e)),a},updateFieldValue:function(e,t){var i=a([this.props.fieldDef.name].concat(t||[]).concat(e));this.getDbEditorApi().updateItem(this.props.item._type,this.props.item._iid,i)},linkedFieldValue:function(e){var t=this;return{value:this.getFieldValue(e),requestChange:function(i){t.updateFieldValue(i,e)}}},hasLink:function(){return this.props.item.links&&!!this.props.item.links[this.props.fieldDef.name]},getLinkToFieldProps:function(){return e.pick(this.props,["item","fieldDef","visibleSections"])}}}),define("databaseEditor/components/itemFields/textItemField",["react","lodash","databaseEditor/components/itemFields/textItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){return e.createClass({displayName:"textItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/buttonItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){return function(){return e.createElement("div",{className:"text-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement(i.textInput,{valueLink:this.linkedFieldValue(),placeholder:"list_dbe_button_placeholder",maxLength:100})),e.createElement(s,t.assign({},{label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps()),'\r\n            showIcon="',!0,'"\r\n    '))}}),define("databaseEditor/components/itemFields/buttonItemField",["react","lodash","databaseEditor/components/itemFields/buttonItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){return e.createClass({displayName:"buttonItemField",mixins:[s],render:i})}),define("databaseEditor/components/itemFields/dateItemField.rt",["react","lodash","baseUI","symbols","util","uiAnimations","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s,a,n,r){return function(){function l(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}function o(){var o=this.getValueAsDate();return e.createElement("div",{className:"date-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"text-input"},e.createElement("div",{className:t({"control-text-input":!0,"date-picker-open":this.state.dateBubbleOpen}).transform(function(e,t,i){t&&e.push(i)},[]).join(" "),onClick:this.toggleDateBubble},e.createElement(s.symbol,{name:"calendar"}),e.createElement("span",{ref:"dateSpan",className:t({disabled:t.isEmpty(this.getFieldValue().iso)}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},o?o.toLocaleDateString():a.translate("list_dbe_date_empty"))),this.hasLink()?null:e.createElement(r,t.assign({},{key:"add-link-button",useLinkButton:!0},this.getLinkToFieldProps()))),this.hasLink()?e.createElement(r,l({className:"input-link-to",key:"link-to-field",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder"},this.getLinkToFieldProps())):null,e.createElement(n.tooltipAnimation,{},this.state.dateBubbleOpen?e.createElement(i.bubble,{key:"dateBubble",value:this.getDatePicker(o),width:"301px",closeTriggers:[i.uiConstants.TOOLTIP.TRIGGERS.OUTER_CLICK],alignment:i.uiConstants.TOOLTIP.ALIGNMENT.BOTTOM,styleType:i.uiConstants.TOOLTIP.STYLE_TYPE.CONTENT_ONLY,hideMethod:this.hideDateBubble,targetNode:this.refs.dateSpan,ref:"popup",style:{position:"absolute"}}):null))}return o.apply(this,[])}}),define("databaseEditor/components/itemFields/dateItemField",["react","lodash","baseUI","databaseEditor/mixins/itemFieldMixin","databaseEditor/components/itemFields/dateItemField.rt"],function(e,t,i,s,a){var n=["January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.createClass({displayName:"dateItemField",mixins:[s],getInitialState:function(){return{dateBubbleOpen:!1}},getDatePicker:function(s){var a={value:s,onChange:this.updateDate,todayLabel:"list_DatePicker_TodayButton_Label",goToSelectedLabel:"list_DatePicker_GoToSelectedButton_Label",monthNames:t.map(n,function(e){return"list_DatePicker_MonthsConstLong_"+e}),days:t.map(r,function(e){return"list_DatePicker_DayConstShort_"+e}),startDay:"list_DatePicker_DayConstShort_Sunday",popOnlyValue:!0,showDelete:!0};return e.createElement(i.datePicker,a)},getValueAsDate:function(){var e=this.getFieldValue();return e&&e.iso?new Date(e.iso):null},updateDate:function(e){this.updateFieldValue(e?e.toISOString():"","iso"),this.toggleDateBubble()},toggleDateBubble:function(){this.setState({dateBubbleOpen:!this.state.dateBubbleOpen})},hideDateBubble:function(){this.setState({dateBubbleOpen:!1})},render:a})}),define("databaseEditor/components/itemFields/imageItemField.rt",["react","lodash","baseUI","databaseEditor/components/linkTo/linkToField"],function(e,t,i,s){return function(){function a(e,i){var s=t.assign({},e,i);return e.hasOwnProperty("style")&&(s.style=t.defaults(s.style,e.style)),e.hasOwnProperty("className")&&i.hasOwnProperty("className")&&(s.className=i.className+" "+e.className),s}function n(){var n=this.getFieldValue();return e.createElement("div",{},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:"image-item-field"},e.createElement(i.imageChangeRemove,{className:"image-panel",addButtonLabel:"list_dbe_edit_item_image_add_image",changeButtonLabel:"list_dbe_edit_item_change_image",removeButtonLabel:"list_dbe_edit_item_remove_image",onChange:this.onMediaRemoved,mediaManager:this.getDbEditorApi().mediaServices.mediaManager,value:this.getWPhotoData(n)}),e.createElement("div",{className:"text-panel"},e.createElement(i.textInput,{label:"list_dbe_edit_item_alt",placeholder:"list_dbe_edit_item_alt_placeholder",value:n.title,onChange:this.updateTitle,maxLength:100,disabled:t.isEmpty(n.src)}),e.createElement(s,a({className:"input-link-to",label:"list_dbe_edit_item_link_label",placeholder:"list_dbe_edit_item_link_placeholder",disabled:t.isEmpty(n.src),showIcon:!0},this.getLinkToFieldProps())))))}return n.apply(this,[])}}),define("databaseEditor/components/itemFields/imageItemField",["react","lodash","databaseEditor/components/itemFields/imageItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s){return e.createClass({displayName:"imageItemField",mixins:[s],updateTitle:function(e){this.updateFieldValue(e,["title"])},getWPhotoData:function(e){return t.assign({type:"Image",uri:e.src},t.pick(e,["title","width","height"]))},onMediaRemoved:function(e){var i={src:"",title:"",height:0,width:0};e&&t.assign(i,{src:e.uri,title:e.title,height:e.height,width:e.width}),this.updateFieldValue(i)},render:i})}),define("databaseEditor/components/itemFields/richTextItemField.rt",["react","lodash","textControls","wixRichText"],function(e,t,i,s){return function(){return e.createElement("div",{className:t({"rich-text-item-field":!0,editing:this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),e.createElement("div",{className:t({"rich-text-input-control":!0,"rich-text-input":!0,"with-toolbar":this.state.editing}).transform(function(e,t,i){t&&e.push(i)},[]).join(" ")},e.createElement(i.richTextFrame,{onOuterClick:this.onOuterClick},this.state.editing?e.createElement(i.textToolBar,t.assign({},{key:"textToolbar",ref:"toolbar",textManager:this.manager,linksHelper:this.linksHelper,cmdState:this.state.cmdState,openLinkPanel:this.openLinkDialog,openColorPicker:this.openColorPicker},this.getToolbarProps())):null,e.createElement(s,{initialData:this.getInitialValue(),onReady:this.setReady,showToolbar:!1,validateHtml:!1,documentServicesApi:this.getDbEditorApi().siteInfo,stylesManager:this.getStyleManager(),linksManager:this.getLinksManager(),onDataChange:this.handleDataChanged,autoGrow:!1,onCut:this.onCutOrCopy,onCopy:this.onCutOrCopy}))))}}),define("databaseEditor/migrations/richTextMigrations",["lodash"],function(e){function t(e){return e=e.replace(n,""),e=e.replace(r,"")}function i(i){return e.get(i,"version",0)>=a?i:(i.text=t(i.text),i.version=a,i)}function s(){return a}var a=3,n=/<hatul[^>]*>/gi,r=/<\/hatul>/gi;return{migrateToCurrentVersion:i,getCurrentVersion:s}}),define("databaseEditor/components/itemFields/richTextItemField",["react","lodash","util","databaseEditor/components/itemFields/richTextItemField.rt","databaseEditor/mixins/itemFieldMixin","textControls","databaseEditor/migrations/richTextMigrations"],function(e,t,i,s,a,n,r){return e.createClass({displayName:"richTextItemField",mixins:[a],getInitialState:function(){return{editing:!1}},getToolbarProps:function(){var e=this.getDbEditorApi().getSiteInfo();return{themeColors:e.theme.colors.getAll(),themeFonts:e.theme.fonts.getAll(),fonts:n.fontUtils.getCurrentSelectableFontsWithParams(e),themeMap:e.theme.fonts.getMap(),panelManager:this.getPanelManager(),isDeveloperMode:e.developerMode.isEnabled()}},getValue:function(){var e=this.getFieldValue();return"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(e=r.migrateToCurrentVersion(e)),{text:e.text,linkList:e.links}},getInitialValue:function(){return n.dataUtils.wrapOrphans(this.getValue().text)},handleDataChanged:function(e){var t=this;this.updateValue({text:e,linkList:t.linksHelper.getAllLinks()})},updateValue:function(e){var t={text:e.text,links:e.linkList};"2.0"===this.getDbEditorApi().getCurrentListVersion()&&(t.version=r.getCurrentVersion()),this.updateFieldValue(t)},getPanelManager:function(){return this.getDbEditorApi().panelManager},openLinkDialog:function(e,t){var s=this.getDbEditorApi(),a=i.link.getLinkPanelProps(s.documentServices,{link:e,callback:t,visibleSections:this.props.visibleSections});s.panelManager.openPanel("panels.toolPanels.linkPanel",a)},setReady:function(e){this.manager=e;var t=this;this.manager.onCmdStateChange(function(e){t.setState({cmdState:e})});var i=this.getDbEditorApi().siteInfo.theme.fonts.getAll(),s=n.fontUtils.getUploadedUsedFonts(this.getValue().text,i);n.ckUtils.insertUploadedFontsToCk(s,this.manager),this.manager.onFocus(function(){t.onFocus()}),this.linksHelper.setCurrentLinks(this.getValue().linkList);var a=this.manager.getCommandsStates();this.setState({cmdState:a})},openColorPicker:function(e,t,i,s,a){var n=this.getDbEditorApi(),r=n.getSiteInfo();n.panelManager.openPanel("panels.toolPanels.colorPicker.colorPickerPanel",{siteCustomColors:r.theme.colors.getCustomUsedInSkins(),sessionStorage:n.getUserPreferences().session,value:t,onChange:e,isBlockingLayerFullScreen:!0,shouldBlockOuterScroll:!0,top:s.top,left:s.left,previewOnHover:a},!0)},onFocus:function(){n.ckUtils.removeOverflowCss(this.manager),this.setState({editing:!0})},isFocusOnToolbar:function(){if(this.refs.toolbar)return!this.refs.toolbar.isColorPickerClosed()||!this.refs.toolbar.isLinkDialogClosed()||this.refs.toolbar.isAnyDropdownOpen()},onOuterClick:function(){this.isFocusOnToolbar()||(n.ckUtils.setOverflowCss(this.manager),this.setState({editing:!1}),this.clearUnusedLinks(),this.manager.unRegisterListener(this.handleCommandState))},getNonPasteableLinkTypes:function(){return t.pick(i.link.LinkTypes,["PHONE_LINK"])},componentWillMount:function(){var e=this;this.linksHelper=new n.LinksHelper([],this.getNonPasteableLinkTypes()),this.linksManager=new n.TextLinksManager(this.linksHelper),this.stylesManager={getFonts:t.partial(n.fontUtils.getCurrentSelectableFontsWithParams,e.getDbEditorApi().siteInfo,!1,!0)}},getStyleManager:function(){return this.stylesManager},getLinksManager:function(){return this.linksManager},onCutOrCopy:function(){this.linksHelper.cacheCopiedLinks()},clearUnusedLinks:function(){var e=this.linksHelper.getAllLinks(),i=this.manager.getLinkRefsList(),s=t.filter(e,function(e){return t.includes(i,e.id)});if(!t.isEqual(s,this.getValue().linkList)){var a=this;this.updateValue({text:a.getValue().text,linkList:s})}},render:s})}),define("databaseEditor/components/itemFields/videoItemField.rt",["react","lodash","baseUI","util"],function(e,t,i,s){return function(){function t(){var t=this.state.status;return e.createElement("div",{className:"inputs-container "+t},e.createElement(i.videoInput,{valueLink:this.linkedFieldValue(),nonEmptyButtonLabel:"list_dbe_edit_item_search_video",emptyButtonLabel:"list_dbe_edit_item_search_video",panelManager:this.getDbEditorApi().panelManager}),e.createElement("div",{},e.createElement(i.textInput,{ref:"textInput",className:"video-url-input",label:"list_dbe_edit_item_video_url",value:this.state.videoUrl,onChange:this.updateVideoUrl,placeholder:this.props.placeholder}),e.createElement("div",{className:"error-msg-and-button"},e.createElement("span",{},"invalid"===t?s.translate("list_dbe_edit_item_bad_video_url"):""),this.state.videoUrl!==this.getVideoUrl()&&"idle"===t?e.createElement(i.button,{key:"update-button",className:"update-button",label:"list_dbe_edit_item_update_video_url",onClick:this.handleClick}):null,"idle"!==t?e.createElement(i.symbol,{key:"validation-status",name:"valid"===t?"inputValidationSuccess":"inputValidationError"}):null)))}return e.createElement("div",{className:"video-item-field"},e.createElement("label",{className:"item-field-title"},this.getFieldDisplayName()),t.apply(this,[]))}}),define("databaseEditor/components/itemFields/videoItemField",["react","lodash","util","baseUI","databaseEditor/components/itemFields/videoItemField.rt","databaseEditor/mixins/itemFieldMixin"],function(e,t,i,s,a,n){function r(){this.success=!0;var e={status:"valid"};if(this.setState(e),t.isEmpty(this.state.videoUrl))this.updateFieldValue({videoId:""});else{var s=i.videoUtils.getVideoDataFromUrl(this.state.videoUrl);this.updateFieldValue({videoType:s.videoType,videoId:s.videoId})}t.delay(function(){this.success=!1,this.setState({status:"idle"})}.bind(this),2e3)}function l(){this.setState({status:"invalid"}),this.refs.textInput.focus()}return e.createClass({displayName:"videoItemField",mixins:[n],getInitialState:function(){return{status:"idle",videoUrl:this.getVideoUrl()}},componentWillReceiveProps:function(e){var i=this.getVideoUrl(e);t.isEqual(this.getVideoUrl(),i)||this.updateVideoUrl(i)},getVideoUrl:function(e){return i.videoUtils.getVideoUrl(this.getFieldValue(null,e))},updateVideoUrl:function(e){this.setState({status:this.success?this.state.status:"idle",videoUrl:e})},handleClick:function(){t.isEmpty(this.state.videoUrl)?t.defer(r.bind(this)):i.videoUtils.verifyVideoUrl(this.state.videoUrl,r.bind(this),l.bind(this))},render:a})}),define("databaseEditor/components/itemEdit",["react","lodash","util","databaseEditor/components/itemEdit.rt","databaseEditor/mixins/dbEditorApiContextMixin","databaseEditor/components/itemFields/textItemField","databaseEditor/components/itemFields/buttonItemField","databaseEditor/components/itemFields/dateItemField","databaseEditor/components/itemFields/imageItemField","databaseEditor/components/itemFields/richTextItemField","databaseEditor/components/itemFields/videoItemField"],function(e,t,i,s,a,n,r,l,o,d,c){function m(e){var i=e.metadata&&e.metadata.showAsHint,s=t.compact([e.type,i]).join("|");return h[s.toLowerCase()]}function p(e){return b[e]}function u(e){if(e.item._iid!==this.props.item._iid)this.setState({saveLabel:null});else{var i=e.saveState!==this.props.saveState;(i=i&&!("Idle"===e.saveState&&t.includes(["Saved","Failed","Error"],this.props.saveState)))&&this.setState({saveLabel:p(e.saveState)})}}var h={string:n,"string|asprice":n,"string|asbutton":r,"wix:image":o,"wix:richtext":d,"wix:video":c,"wix:date":l},b={Error:"list_dbe_edit_item_status_error",Saving:"list_dbe_edit_item_status_saving",Saved:"list_dbe_edit_item_status_saved",Idle:"list_dbe_edit_item_status_idle",Failed:"list_dbe_edit_item_status_error"},_={Title:"list_dbe_title_placeholder",Subtitle:"list_dbe_subtitle_placeholder",Description:"list_dbe_description_placeholder",Price:"list_dbe_price_placeholder",Video:"list_dbe_edit_item_video_link_placeholder"};return e.createClass({displayName:"itemEdit",mixins:[a,i.propTypesFilterMixin,i.blockOuterScrollMixin,i.translationMixin],propTypes:{item:e.PropTypes.object.isRequired,itemSchema:e.PropTypes.object.isRequired,saveState:e.PropTypes.string.isRequired,visibleFields:e.PropTypes.arrayOf(e.PropTypes.string)},getInitialState:function(){return{saveLabel:null}},componentWillReceiveProps:function(e){u.call(this,e)},getFields:function(){var e=this;return t(e.props.itemSchema.fields).filter(function(i){return t.includes(e.props.visibleFields,i.name)||"title"===i.name}).map(function(e){return{component:m(e),definition:e,placeholder:_[e.displayName]||""}}).filter("component").value()},render:s})}),define("databaseEditor/dbEditor/dbEditor.rt",["react","lodash","databaseEditor/components/itemsList","databaseEditor/components/itemEdit","uiAnimations"],function(e,t,i,s,a){return function(){return e.createElement("div",{className:"db-editor-container",onMouseDown:this.blockMiddleMouseClick},e.createElement(i,{items:this.props.items,hiddenItems:this.props.hiddenItems,openedItemId:this.props.currentItemId,listName:this.props.listName,listId:this.props.currentListId,visibleFields:this.props.visibleFields}),e.createElement(a.dbEditItemSlide,{direction:"right"},this.props.currentItemId?e.createElement(s,{key:"item-edit",item:this.getItem(this.props.currentItemId),itemSchema:this.props.itemSchema,visibleFields:this.props.visibleFields,saveState:this.props.saveState}):null))}}),define("databaseEditor/dbEditor/dbEditor",["react","lodash","uiAnimations","databaseEditor/dbEditor/dbEditor.rt"],function(e,t,i,s){return e.createClass({displayName:"dbEditor",mixins:[i.animationManager],propTypes:{dbEditorApi:e.PropTypes.object.isRequired,currentListId:e.PropTypes.string,items:e.PropTypes.array,hiddenItems:e.PropTypes.array,currentItemId:e.PropTypes.string,listName:e.PropTypes.string,itemSchema:e.PropTypes.object,saveState:e.PropTypes.string,visibleFields:e.PropTypes.arrayOf(e.PropTypes.string)},childContextTypes:{dbEditorApi:e.PropTypes.object.isRequired,mediaServices:e.PropTypes.object},getDefaultProps:function(){return{items:[]}},componentDidMount:function(){this.props.dbEditorApi.bi.dbEditorOpenSuccess(this.props.currentListId)},componentWillUnmount:function(){this.props.dbEditorApi.updateList()},getChildContext:function(){return{dbEditorApi:this.props.dbEditorApi,mediaServices:this.props.dbEditorApi.mediaServices}},getItem:function(e){return t.find(this.props.items,{_iid:e})||t.find(this.props.hiddenItems,{_iid:e})},blockMiddleMouseClick:function(e){if(1===e.button)return!1},render:s})}),define("databaseEditor/dbEditor/DbEditorApi",["lodash","mediaServices","util","experiment","userPreferences"],function(e,t,i,s){function a(e){return"databaseEditor.panels."+e}function n(e){var t=this.dataService.wasRepoLoadErroneous(),i=this.dataService.wasListLoadErroneous(e);t||i?(this.bi.listLoadFailed(e,!t,!i),this.panelManager.openPanel(a("loadFailedMessagePanel"),{onConfirm:function(){window.location.reload()}})):r.call(this)}function r(){var t=p.call(this);e.forEach(this.stateChangedCallbacks,function(e){e(t)})}function l(){return this.appbuilderServices.data.lists.getItems(this.currentListId)}function o(){return this.appbuilderServices.data.lists.getHiddenItems(this.currentListId)}function d(){return this.appbuilderServices.data.lists.getListName(this.currentListId)}function c(){var t=this.appbuilderServices.layout.getAllFields,i=e(this.currentListId).thru(t).reject("hidden").map("name").value(),s=e(t(this.currentListId,"Mobile")).reject("hidden").map("name").value();return e.uniq(i.concat(s))}function m(e,t){t?window.setTimeout(m.bind(this,e),t):(this.saveState=e,r.call(this))}function p(){var e=this.dataService.wasRepoLoaded(),t=e&&this.dataService.wasListLoaded(this.currentListId);return{currentListId:this.currentListId,items:t?l.call(this):[],hiddenItems:t?o.call(this):[],currentItemId:this.currentItemId,listName:e?d.call(this):null,itemSchema:e?this.appbuilderServices.data.lists.getItemSchema(this.currentListId):null,visibleFields:this.visibleFields,dbEditorApi:this,openPanels:this.panelManager.getOpenPanels(),saveState:this.saveState,loading:!t}}function u(){function e(){if(m.call(this,g.saved),this.savePending)return this.savePending=!1,void u.call(this);window.setTimeout(function(){this.saveState!==g.saving&&m.call(this,g.idle)}.bind(this),this.idleTimeout)}function t(){this.savePending=!1,m.call(this,g.failed),m.call(this,g.idle,this.idleTimeout),this.panelManager.openPanel(a("saveFailedMessagePanel"))}this.sohuldRender=!0,!0!==this.disableAutoSave?this.saveState!==g.saving?(m.call(this,g.saving),this.appbuilderServices.save(e.bind(this),t.bind(this))):this.savePending=!0:r.call(this)}function h(e){var t=Object.create(e);return t.openPanel=function(t,i){e.openPanel(t,i,!0)},t}function b(t,i){return e.filter(t,function(t){return e.find(i,{_iid:t._iid})})}function _(t,s){var a=e.assign({},s,{title:i.translate("list_dbe_prefix_for_duplicated_item")+s.title});return this.appbuilderServices.data.items.create(t,a)}function f(i,a,r,l,o,d,m,u,b,_,f,E){e.bindAll(this,["getServiceTopology","getUserPreferences","setCurrentList","getPagesData","getSiteMenuItems","createDefaultDataItem","setCurrentItem","debouncedSave","broadcastStateChanged","moveItem","addItem","updateItem","duplicateItems","deleteItems","showItems","hideItems","getCurrentListVersion","registerForStateChanged","getSiteInfo"]),this.disableAutoSave=f,this.idleTimeout=b,this.dataService=i,this.appbuilderServices=r.wixapps.appbuilder,this.documentServices=r,this.siteInfo=l,this.serviceTopology=d,this.stateChangedCallbacks=[],this.currentListId=u,this.currentItemId=null,this.saveState=g.idle,this.savePending=!1,this.sohuldRender=!1,this.panelManager=h(m),this.mediaServices=E||new t,this.userPreferences=o,this.bi=a,s.isOpen("appBuilderDataMigration")&&this.appbuilderServices.migration.migrateList(u),i.registerForUpdates(n.bind(this)),_&&(this.visibleFields=c.call(this),_(p.call(this)))}var g={idle:"Idle",saved:"Saved",failed:"Failed",saving:"Saving"};return f.prototype={updateList:function(){this.sohuldRender&&e.has(this.appbuilderServices.data,"markDataAsUpdated")&&(this.appbuilderServices.data.markDataAsUpdated(this.currentListId),this.sohuldRender=!1)},getServiceTopology:function(){return this.serviceTopology},getUserPreferences:function(){return this.userPreferences},setCurrentList:function(e){this.currentListId=e,this.currentItemId=null,this.dataService.loadListData(e),this.visibleFields=c.call(this),r.call(this)},getPagesData:function(){return this.documentServices.pages.getPagesData()},getSiteMenuItems:function(){return this.documentServices.mainMenu.getMenu()},createDefaultDataItem:function(e){return this.documentServices.data.createItem(e)},setCurrentItem:function(e,t){this.currentItemId=e,r.call(this),e&&t&&this.bi.itemEdit(t,this.currentListId,e)},debouncedSave:e.debounce(u,500),broadcastStateChanged:r,moveItem:function(e,t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=i.itemIds,a=s[e];s.splice(t,0,s.splice(e,1)[0]),this.bi.itemMove(this.currentListId,i.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,s),u.call(this)},addItem:function(t,i){i=i||e.noop;var s=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),a=this.appbuilderServices.data.items.create(s),n=this.appbuilderServices.data.lists.selection.get(this.currentListId),r=n.itemIds;return r.unshift(a),this.bi.itemAdd(t,this.currentListId,n.id,a),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,r),i(a),u.call(this),a},updateItem:function(e,t,i){this.appbuilderServices.data.items.update(e,t,i),this.debouncedSave(),r.call(this)},duplicateItems:function(t,i){var s=e.map(t,"_iid"),a=this.appbuilderServices.data.lists.getDatabaseId(this.currentListId),n=this.appbuilderServices.data.lists.selection.get(this.currentListId);this.bi.itemsDuplicate(i,this.currentListId,n.id,s),e.forEach(b(t,o.call(this)),e.bind(_,this,a));var r=e.map(b(t,l.call(this)),e.bind(_,this,a)),d=n.itemIds,c=e.findLastIndex(d,function(t){return e.includes(s,t)});d.splice.apply(d,[c+1,0].concat(r)),this.appbuilderServices.data.lists.selection.setManual(this.currentListId,d),this.currentItemId&&this.setCurrentItem(e.last(r)),u.call(this)},deleteItems:function(t,i,s){function n(){var a=r.appbuilderServices.data.lists.selection.get(r.currentListId);r.bi.itemsDelete(i,r.currentListId,a.id,e.map(t,"_iid")),e.forEach(t,function(t){if(r.currentItemId===t._iid){var i=e.map(l.call(r),"_iid"),s=i.indexOf(t._iid),a=i[s+1]||i[s-1]||null;r.setCurrentItem(a)}r.appbuilderServices.data.items.delete(t._type,t._iid)}),s(),u.call(r)}var r=this;s=s||e.noop,this.panelManager.openPanel(a("deleteItemsConfirmationPanel"),{onConfirm:n,onCancel:e.noop})},showItems:function(t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=e.map(t,"_iid"),a=e.union(i.itemIds,s);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),u.call(this)},hideItems:function(t){var i=this.appbuilderServices.data.lists.selection.get(this.currentListId),s=e.map(t,"_iid"),a=e.difference(i.itemIds,s);this.appbuilderServices.data.lists.selection.setManual(this.currentListId,a),u.call(this)},getCurrentListVersion:function(){return this.appbuilderServices.data.lists.getListVersion(this.currentListId)},registerForStateChanged:function(e){this.stateChangedCallbacks.push(e)},getSiteInfo:function(){return this.siteInfo}},f}),define("databaseEditor/panels/deleteItemsConfirmationPanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,className:"delete-list-items-confirmation",type:"important",panelTitle:this.translateIfNeeded("list_dbe_delete_are_you_sure_title"),onCancel:this.props.onCancel,onConfirm:this.props.onConfirm,confirmLabel:"list_dbe_delete_are_you_sure_confirm_button",cancelLabel:"list_dbe_delete_are_you_sure_cancel_button"},e.createElement(s.symbol,{name:"garbage-truck-clipart",className:"image"}),e.createElement("div",{className:"text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_items_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_delete_are_you_sure_text"))))}}),define("databaseEditor/panels/deleteItemsConfirmationPanel",["react","util","lodash","databaseEditor/panels/deleteItemsConfirmationPanel.rt"],function(e,t,i,s){return e.createClass({displayName:"deleteItems",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/saveFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){return function(){return e.createElement(i.frames.messagePanelFrame,{className:"list-save-failed-panel",editorAPI:this.getEditorAPI(),panelName:this.props.panelName,confirmLabel:"list_dbe_general_error_button",panelTitle:this.translateIfNeeded("list_dbe_general_error_dialog_title")},e.createElement("div",{className:"content-wrapper"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_subtitle")),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text")),e.createElement("p",{},e.createElement("br",{})),e.createElement("p",{},this.translateIfNeeded("list_dbe_general_error_dialog_text_2")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/"))))}}),define("databaseEditor/panels/saveFailedMessagePanel",["react","util","lodash","core","databaseEditor/panels/saveFailedMessagePanel.rt"],function(e,t,i,s,a){return e.createClass({displayName:"saveFailedMessagePanel",mixins:[t.translationMixin,s.mixins.editorAPIMixin],render:a})}),define("databaseEditor/panels/loadFailedMessagePanel.rt",["react","lodash","panels","baseUI"],function(e,t,i,s){return function(){return e.createElement(i.frames.confirmationPanelFrame,{panelName:this.props.panelName,panelTitle:this.translateIfNeeded("list_dbe_loading_error_title"),className:"list-load-failed-panel",onConfirm:this.props.onConfirm,onCancel:this.props.onCancel,confirmLabel:"list_dbe_loading_error_button",cancelLabel:"list_dbe_error_loading_close_manage_items"},e.createElement(s.symbol,{name:"plaster",className:"error-img"}),e.createElement("div",{className:"msg-text"},e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_subtitle")),e.createElement("span",{},this.translateIfNeeded("list_dbe_loading_error_text")),e.createElement("a",{className:"support-link",href:"https://www.wix.com/support/html5/"},"https://www.wix.com/support/")))}}),define("databaseEditor/panels/loadFailedMessagePanel",["react","util","lodash","databaseEditor/panels/loadFailedMessagePanel.rt"],function(e,t,i,s){return e.createClass({displayName:"loadFailedMessagePanel",mixins:[t.translationMixin],render:s})}),define("databaseEditor/panels/panels",["databaseEditor/panels/deleteItemsConfirmationPanel","databaseEditor/panels/saveFailedMessagePanel","databaseEditor/panels/loadFailedMessagePanel"],function(e,t,i){return{deleteItemsConfirmationPanel:e,saveFailedMessagePanel:t,loadFailedMessagePanel:i}}),define("databaseEditor/bi/events",[],function(){return{LIST_DB_MANAGER_OPENED:{src:59,endpoint:"listim2",evid:107,fields:{list_part_id:"string"}},LIST_DB_MANAGER_ERROR_LOADING:{src:59,endpoint:"listim2",evid:108,fields:{list_part_id:"string",error_description:"string"}},LIST_DB_MANAGER_REORDER_ITEMS_DROP:{src:59,endpoint:"listim2",evid:109,fields:{item_id:"string",list_part_id:"string",selector_id:"string"}},LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK:{src:59,endpoint:"listim2",evid:110,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_id:"string"}},LIST_DB_MANAGER_SELECT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:113,fields:{list_part_id:"string",item_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_SELECT_ALL_CLICK:{src:59,endpoint:"listim2",evid:114,fields:{list_part_id:"string",state_after_click:"bool"}},LIST_DB_MANAGER_DUPLICATE_ITEM:{src:59,endpoint:"listim2",evid:117,fields:{origin:"string",list_part_id:"string",selector_id:"string",source_item_ids:"string"}},LIST_DB_MANAGER_DELETE_ITEMS_CLICK:{src:59,endpoint:"listim2",evid:118,fields:{origin:"string",list_part_id:"string",selector_id:"string",item_ids:"string"}},LIST_DB_MANAGER_EDIT_ITEM_CLICK:{src:59,endpoint:"listim2",evid:119,fields:{origin:"string",list_part_id:"string",item_id:"string"}},LIST_DB_MANAGER_LIST_LOAD_FAIL:{src:59,endpoint:"listim2",evid:121,fields:{list_part_id:"string",repo_loaded:"bool",data_loaded:"bool"}}}}),define("databaseEditor/bi/service",["databaseEditor/bi/events","coreUtilsLib"],function(e,t){function i(e){this._reportBI=e}return i.prototype={sendEvent:function(e,i){try{this._reportBI(e,i)}catch(e){t.log.info("Error sending BI event",e)}},dbEditorOpenSuccess:function(t){this.sendEvent(e.LIST_DB_MANAGER_OPENED,{list_part_id:t})},dbEditorOpenFailed:function(t,i){this.sendEvent(e.LIST_DB_MANAGER_ERROR_LOADING,{list_part_id:t,error_description:i.toString()})},listLoadFailed:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_LIST_LOAD_FAIL,{list_part_id:t,repo_loaded:i?"true":"false",data_loaded:s?"true":"false"})},itemMove:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_REORDER_ITEMS_DROP,{item_id:s,list_part_id:t,selector_id:i})},itemAdd:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_ADD_NEW_ITEM_CLICK,{origin:t,list_part_id:i,selector_id:s,item_id:a})},itemsDuplicate:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_DUPLICATE_ITEM,{origin:t,list_part_id:i,selector_id:s,source_item_ids:a.join(",")})},itemsDelete:function(t,i,s,a){this.sendEvent(e.LIST_DB_MANAGER_DELETE_ITEMS_CLICK,{origin:t,list_part_id:i,selector_id:s,item_ids:a.join(",")})},itemEdit:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_EDIT_ITEM_CLICK,{origin:t,list_part_id:i,item_id:s})},itemSelectionToggle:function(t,i,s){this.sendEvent(e.LIST_DB_MANAGER_SELECT_ITEM_CLICK,{list_part_id:t,item_id:i,state_after_click:!!s})},allItemsSelectionToggle:function(t,i){this.sendEvent(e.LIST_DB_MANAGER_SELECT_ALL_CLICK,{list_part_id:t,state_after_click:!!i})}},i}),define("databaseEditor",["databaseEditor/dbEditor/dbEditor","databaseEditor/dbEditor/DbEditorApi","databaseEditor/panels/panels","databaseEditor/bi/service"],function(e,t,i,s){return{dbEditor:e,DbEditorApi:t,panels:i,BIService:s}});
//# sourceMappingURL=databaseEditor.min.js.map